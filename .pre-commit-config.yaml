---
# Pre-commit hooks delegating to Taskfile tasks (single source of truth)
# Taskfile tasks in .taskfiles/lint/Taskfile.yaml contain all tool configurations
# Config files in .github/linters/ remain the single source of truth for tool settings
fail_fast: false
repos:
  - repo: local
    hooks:
      # Formatting tasks (auto-fix on commit)
      - id: task-lint-fix-prettier
        name: Task - Fix Prettier Formatting
        entry: task lint:fix:prettier
        language: system
        types_or: [json, yaml, markdown, javascript, css, html]
        pass_filenames: false

      - id: task-lint-fix-terraform
        name: Task - Fix Terraform Formatting
        entry: task lint:fix:terraform
        language: system
        files: \.tf$
        pass_filenames: false

      - id: task-lint-fix-packer
        name: Task - Fix Packer Formatting
        entry: task lint:fix:packer
        language: system
        files: \.pkr\.hcl$
        pass_filenames: false

      - id: task-lint-fix-shell
        name: Task - Fix Shell Formatting
        entry: task lint:fix:shell
        language: system
        types: [shell]
        pass_filenames: false

      # Linting checks (fail on issues)
      - id: task-lint-check-yaml
        name: Task - Check YAML Linting
        entry: task lint:check:yaml
        language: system
        types: [yaml]
        pass_filenames: false

      - id: task-lint-check-markdown
        name: Task - Check Markdown Linting
        entry: task lint:check:markdown
        language: system
        types: [markdown]
        pass_filenames: false

  # Shell script checks (Python wrapper for portability)
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.11.0.1
    hooks:
      - id: shellcheck

  # Security checks for secrets
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: detect-aws-credentials
        args: ["--allow-missing-credentials"]
      - id: detect-private-key
      - id: check-merge-conflict
      - id: check-added-large-files
        args: ["--maxkb=1024"]
